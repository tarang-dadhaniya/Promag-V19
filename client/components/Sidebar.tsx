import { cn } from "@/lib/utils";
import { Dropdown } from "./ui/dropdown";
import { useMemo } from "react";
import { useTranslation } from "react-i18next";

interface SidebarProps {
  className?: string;
  onManagePublicationsClick?: () => void;
  onManageCompanyClick?: () => void;
  collections?: { id: string; title: string }[];
  selectedCollectionId?: string | null;
  onSelectCollection?: (id: string | null) => void;
  selectedCategory?: string | null;
  onSelectCategory?: (value: string | null) => void;
  activeMenuItem?: string;
}

const PromagLogo = () => (
  <svg width="260" height="69" viewBox="0 0 260 69" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path fillRule="evenodd" clipRule="evenodd" d="M58.575 17.2191C62.5605 17.5625 66.1221 18.7253 69.1227 20.9684C72.1234 18.7253 75.6851 17.5625 79.6705 17.2191V37.7053C75.9549 38.9964 72.4132 41.7892 70.0792 44.5745V33.4323C70.7825 33.0811 71.2674 32.3566 71.2674 31.5151C71.2674 30.3295 70.3071 29.3696 69.1227 29.3696C67.9382 29.3696 66.9781 30.3295 66.9781 31.5151C66.9781 32.3574 67.4608 33.0832 68.1658 33.4335V44.5757C65.8323 41.79 62.2911 38.9964 58.575 37.7053L58.575 17.2191Z" fill="white"/>
    <path fillRule="evenodd" clipRule="evenodd" d="M50 23.2469C50.533 23.1016 51.0292 23.2049 51.495 23.4224L51.4976 42.3091C53.4691 42.133 57.4028 42.2019 59.5467 43.8161C56.653 43.4392 52.8934 43.8194 50.0001 44.1408V23.2469L50 23.2469ZM53.9631 19.7475C54.5335 19.7006 55.016 19.8072 55.4581 19.9841L55.4607 38.8101C60.0756 39.9863 62.2946 41.7427 63.5571 43.7327C60.3632 41.722 57.1566 40.621 53.9632 40.6418V19.7475L53.9631 19.7475ZM88.2458 23.2469C87.7128 23.1016 87.2166 23.2049 86.7508 23.4224L86.7482 42.3091C84.7767 42.133 80.843 42.2019 78.6991 43.8161C81.5928 43.4392 85.3524 43.8194 88.2457 44.1408V23.2469L88.2458 23.2469ZM84.2828 19.7475C83.7125 19.7006 83.2299 19.8072 82.7878 19.9841L82.7853 38.8101C78.1703 39.9863 75.9514 41.7427 74.6888 43.7327C77.8827 41.722 81.0894 40.621 84.2827 40.6418V19.7475L84.2828 19.7475Z" fill="white"/>
    <path fillRule="evenodd" clipRule="evenodd" d="M201.375 40.3975C202.24 40.3975 203.032 40.1703 203.762 39.7058C204.518 39.2246 205.095 38.5783 205.518 37.7882C205.962 36.9599 206.173 36.0753 206.173 35.1358C206.173 34.1877 205.967 33.2881 205.518 32.4503C205.095 31.6603 204.518 31.014 203.762 30.5328C203.032 30.0678 202.24 29.8411 201.375 29.8411C200.717 29.8411 200.073 29.9449 199.455 30.1741C198.894 30.3825 198.401 30.6951 197.987 31.1276L197.976 31.14C197.495 31.6199 197.168 32.2108 196.95 32.8501C196.696 33.5891 196.577 34.3554 196.577 35.1358C196.577 36.7803 197.012 38.2985 198.296 39.3895C198.698 39.7345 199.164 39.9757 199.668 40.1351C200.223 40.3103 200.793 40.3975 201.375 40.3975ZM206.139 41.8185C204.731 43.2005 202.95 43.9595 200.778 43.9595C199.235 43.9595 197.78 43.5821 196.482 42.7422C195.224 41.9281 194.268 40.8304 193.608 39.4853C192.936 38.1183 192.618 36.6568 192.618 35.1358C192.618 33.6301 192.953 32.1945 193.627 30.8473C194.299 29.5031 195.258 28.3967 196.502 27.5547C197.787 26.6858 199.229 26.2789 200.778 26.2789C202.207 26.2789 203.597 26.5874 204.8 27.3849C205.354 27.7522 205.859 28.1749 206.319 28.6428C206.465 28.1894 206.721 27.7801 207.084 27.4259C207.676 26.8489 208.403 26.5442 209.23 26.5442H210V43.1893C210 45.5676 209.385 47.8506 207.623 49.5299C205.894 51.1789 203.656 51.7809 201.308 51.7809H200.538V48.2193H201.308C202.618 48.2193 203.834 47.8904 204.822 47.0066C205.873 46.0658 206.14 44.6041 206.14 43.2557V41.8183L206.139 41.8185ZM187.45 41.975C186.176 43.257 184.561 43.9595 182.593 43.9595C180.982 43.9595 179.45 43.5452 178.234 42.4533C177.083 41.42 176.52 40.0932 176.52 38.5496V38.3503C176.52 36.5743 177.241 35.1358 178.793 34.2375C180.244 33.3973 181.852 33.0403 183.521 33.0403H186.611V33.8105C186.611 34.0641 186.534 34.3622 186.468 34.607C186.345 35.0653 186.076 35.4631 185.749 35.8023C185.289 36.2813 184.671 36.4694 184.018 36.4694H183.488C182.672 36.4694 181.857 36.6089 181.13 36.9934C180.575 37.2865 180.38 37.734 180.38 38.3506C180.38 38.9447 180.57 39.4138 181.043 39.7809C181.606 40.2171 182.29 40.365 182.991 40.365C184.143 40.365 185.151 40.0267 185.986 39.2216C186.82 38.4162 187.159 37.4139 187.159 36.2627V32.7497C187.159 31.9257 187.004 31.0173 186.375 30.4285C185.724 29.8199 184.741 29.6754 183.885 29.6754C183.161 29.6754 182.402 29.8042 181.804 30.2401C181.28 30.6219 180.895 31.1031 180.658 31.7064L180.394 32.3761L176.731 31.2107L177.039 30.4419C177.53 29.2159 178.401 28.2282 179.44 27.4323C180.743 26.4338 182.336 26.0802 183.952 26.0802C185.378 26.0802 186.87 26.3181 188.093 27.0952C189.139 27.7594 189.934 28.6554 190.425 29.7929L190.431 29.8048C190.628 30.2835 190.75 30.7971 190.828 31.3081C190.898 31.7703 190.953 32.2485 190.953 32.7164V43.6942H190.182C189.356 43.6942 188.631 43.3899 188.047 42.8058C187.795 42.5543 187.596 42.2761 187.45 41.9751L187.45 41.975ZM153.246 27.984C153.556 27.6913 153.889 27.4253 154.249 27.1956C155.242 26.5608 156.379 26.3121 157.546 26.3121C158.775 26.3121 159.959 26.584 161.006 27.2421C161.691 27.6726 162.251 28.2261 162.702 28.8703C163.248 28.2322 163.881 27.6758 164.615 27.2462C165.707 26.607 166.928 26.3453 168.185 26.3453C170.074 26.3453 171.807 26.9029 173.073 28.3476C174.319 29.7704 174.789 31.5484 174.789 33.4126V43.9595H174.018C173.174 43.9595 172.43 43.6518 171.833 43.0544C171.236 42.457 170.928 41.7143 170.928 40.8694V33.9759C170.928 32.9326 170.729 31.8598 170.078 31.0162C169.476 30.237 168.572 30.0065 167.622 30.0065C166.576 30.0065 165.692 30.3275 165.014 31.1386C164.301 31.9926 164.017 33.0035 164.017 34.1082V40.9025C164.017 41.7295 163.712 42.4561 163.136 43.0476C162.546 43.6521 161.804 43.9593 160.96 43.9593H160.19V33.9094C160.19 32.8678 159.973 31.8381 159.324 31.0008C158.72 30.2212 157.843 29.9732 156.884 29.9732C156.2 29.9732 155.567 30.1368 155.005 30.53C154.442 30.9244 154.027 31.4388 153.738 32.0627C153.423 32.7415 153.279 33.4606 153.279 34.2079V40.8694C153.279 41.7142 152.971 42.4569 152.374 43.0543C151.776 43.6518 151.034 43.9594 150.189 43.9594H149.419V26.6102H153.246V27.984L153.246 27.984Z" fill="white"/>
    <path fillRule="evenodd" clipRule="evenodd" d="M138.633 40.6296C139.552 40.6296 140.409 40.4129 141.187 39.9205C141.955 39.4343 142.545 38.7884 142.975 37.987C143.423 37.1493 143.629 36.2496 143.629 35.3014C143.629 34.3496 143.413 33.4533 142.971 32.6097C142.54 31.7857 141.942 31.118 141.162 30.6111C140.384 30.105 139.528 29.8742 138.599 29.8742C137.664 29.8742 136.786 30.0884 135.992 30.5853C135.222 31.0665 134.632 31.7062 134.211 32.5104C133.77 33.3511 133.569 34.2532 133.569 35.2021C133.569 36.1649 133.781 37.0745 134.227 37.9272C134.656 38.7463 135.251 39.4081 136.03 39.905C136.822 40.4094 137.696 40.6295 138.633 40.6295L138.633 40.6296ZM138.633 26.3123C140.236 26.3123 141.752 26.6922 143.143 27.4918C144.507 28.2769 145.591 29.3605 146.376 30.725C147.171 32.1066 147.556 33.6103 147.556 35.2024C147.556 36.8203 147.179 38.3538 146.377 39.7596C145.594 41.1329 144.513 42.2235 143.143 43.0119C141.743 43.8169 140.213 44.1919 138.599 44.1919C136.991 44.1919 135.474 43.8041 134.085 42.9929C132.729 42.2007 131.646 41.123 130.857 39.765C130.06 38.3901 129.676 36.8913 129.676 35.3017C129.676 33.6789 130.046 32.1338 130.856 30.7251C131.641 29.3605 132.725 28.2769 134.089 27.492C135.489 26.687 137.019 26.3124 138.633 26.3124V26.3123ZM124.299 28.1162C124.61 27.8156 124.954 27.5474 125.336 27.3175C126.337 26.7147 127.43 26.3788 128.6 26.3788C128.89 26.3788 129.237 26.3747 129.522 26.4224L130.165 26.5296V30.4952L129.31 30.3998C129.049 30.3707 128.764 30.3383 128.501 30.3383C127.257 30.3383 126.103 30.6601 125.375 31.7262C124.614 32.8396 124.333 34.1332 124.333 35.4675V40.8699C124.333 41.7147 124.025 42.4575 123.427 43.0549C122.83 43.6523 122.087 43.96 121.242 43.96H120.472V26.6108H124.299V28.1166L124.299 28.1162ZM105.616 23.0799V43.9595H101.657V19.2529H110.182C111.856 19.2529 113.566 19.5195 115.063 20.3016C116.33 20.9638 117.395 21.8871 118.096 23.1441C118.759 24.3318 119.072 25.6229 119.072 26.9825C119.072 28.4057 118.733 29.7516 118.002 30.9739C117.246 32.2377 116.146 33.1692 114.84 33.8339C113.332 34.6006 111.639 34.8903 109.96 34.9114H109.946L109.932 34.911C108.979 34.889 107.961 34.6481 107.391 33.8131C107.022 33.27 106.761 32.6531 106.761 31.9872V31.1178H109.851C110.862 31.1178 111.952 30.9792 112.86 30.508C113.534 30.1589 114.136 29.6835 114.519 29.0177C114.871 28.4065 115.046 27.7539 115.046 27.049C115.046 25.946 114.686 25.0123 113.91 24.2264C112.956 23.2612 111.265 23.0798 109.983 23.0798H105.616L105.616 23.0799Z" fill="white"/>
  </svg>
);

const navItems = [
  {
    icon: (
      <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M3.79907 6.4V1.5H12.1991V6.4" stroke="currentColor" strokeWidth="1.5" strokeLinecap="round" strokeLinejoin="round"/>
        <path d="M3.8 12.7H2.4C2.0287 12.7 1.6726 12.5525 1.41005 12.29C1.1475 12.0274 1 11.6713 1 11.3V7.80002C1 7.42872 1.1475 7.07263 1.41005 6.81008C1.6726 6.54752 2.0287 6.40002 2.4 6.40002H13.6C13.9713 6.40002 14.3274 6.54752 14.5899 6.81008C14.8525 7.07263 15 7.42872 15 7.80002V11.3C15 11.6713 14.8525 12.0274 14.5899 12.29C14.3274 12.5525 13.9713 12.7 13.6 12.7H12.2" stroke="currentColor" strokeWidth="1.5" strokeLinecap="round" strokeLinejoin="round"/>
        <path d="M12.1991 9.90002H3.79907V15.5H12.1991V9.90002Z" stroke="currentColor" strokeWidth="1.5" strokeLinecap="round" strokeLinejoin="round"/>
      </svg>
    ),
    label: "Manage Publications",
    href: "/",
    active: true,
  },
  {
    icon: (
      <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M1 7.16661L8 1.72217L15 7.16661V15.7222C15 16.1347 14.8361 16.5304 14.5444 16.8221C14.2527 17.1138 13.857 17.2777 13.4444 17.2777H2.55556C2.143 17.2777 1.74733 17.1138 1.45561 16.8221C1.16389 16.5304 1 16.1347 1 15.7222V7.16661Z" stroke="currentColor" strokeWidth="1.5" strokeLinecap="round" strokeLinejoin="round"/>
        <path d="M5.66675 17.2778V9.5H10.3334V17.2778" stroke="currentColor" strokeWidth="1.5" strokeLinecap="round" strokeLinejoin="round"/>
      </svg>
    ),
    label: "Manage Company",
    href: "/company",
  },
  {
    icon: (
      <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M2.90894 14.2273V9.77271" stroke="currentColor" strokeWidth="1.5" strokeLinecap="round" strokeLinejoin="round"/>
        <path d="M2.90894 7.22725V2.77271" stroke="currentColor" strokeWidth="1.5" strokeLinecap="round" strokeLinejoin="round"/>
        <path d="M8 14.2273V8.5" stroke="currentColor" strokeWidth="1.5" strokeLinecap="round" strokeLinejoin="round"/>
        <path d="M8 5.95452V2.77271" stroke="currentColor" strokeWidth="1.5" strokeLinecap="round" strokeLinejoin="round"/>
        <path d="M13.0911 14.2272V11.0454" stroke="currentColor" strokeWidth="1.5" strokeLinecap="round" strokeLinejoin="round"/>
        <path d="M13.0911 8.49998V2.77271" stroke="currentColor" strokeWidth="1.5" strokeLinecap="round" strokeLinejoin="round"/>
        <path d="M1 9.77271H4.81818" stroke="currentColor" strokeWidth="1.5" strokeLinecap="round" strokeLinejoin="round"/>
        <path d="M6.09106 5.95459H9.90925" stroke="currentColor" strokeWidth="1.5" strokeLinecap="round" strokeLinejoin="round"/>
        <path d="M11.1819 11.0454H15.0001" stroke="currentColor" strokeWidth="1.5" strokeLinecap="round" strokeLinejoin="round"/>
      </svg>
    ),
    label: "Manage Apps",
    href: "/apps",
  },
  {
    icon: (
      <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M1 7.16661L8 1.72217L15 7.16661V15.7222C15 16.1347 14.8361 16.5304 14.5444 16.8221C14.2527 17.1138 13.857 17.2777 13.4444 17.2777H2.55556C2.143 17.2777 1.74733 17.1138 1.45561 16.8221C1.16389 16.5304 1 16.1347 1 15.7222V7.16661Z" stroke="currentColor" strokeWidth="1.5" strokeLinecap="round" strokeLinejoin="round"/>
        <path d="M5.66675 17.2778V9.5H10.3334V17.2778" stroke="currentColor" strokeWidth="1.5" strokeLinecap="round" strokeLinejoin="round"/>
      </svg>
    ),
    label: "Manage Reader",
    href: "/reader",
  },
  {
    icon: (
      <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M1 7.16661L8 1.72217L15 7.16661V15.7222C15 16.1347 14.8361 16.5304 14.5444 16.8221C14.2527 17.1138 13.857 17.2777 13.4444 17.2777H2.55556C2.143 17.2777 1.74733 17.1138 1.45561 16.8221C1.16389 16.5304 1 16.1347 1 15.7222V7.16661Z" stroke="currentColor" strokeWidth="1.5" strokeLinecap="round" strokeLinejoin="round"/>
        <path d="M5.66675 17.2778V9.5H10.3334V17.2778" stroke="currentColor" strokeWidth="1.5" strokeLinecap="round" strokeLinejoin="round"/>
      </svg>
    ),
    label: "Push Notifications",
    href: "/notifications",
  },
];

export function Sidebar({ className, onManagePublicationsClick, collections = [], selectedCollectionId = null, onSelectCollection, selectedCategory = null, onSelectCategory }: SidebarProps) {
  const { t } = useTranslation();
  const categoryOptions = useMemo(() => [
    { value: "action", label: t("categories.action") },
    { value: "cinematic", label: t("categories.cinematic") },
    { value: "comic", label: t("categories.comic") },
    { value: "drama", label: t("categories.drama") },
    { value: "education", label: t("categories.education") },
  ], [t]);

  const collectionOptions = useMemo(() => collections.map(c => ({ value: c.id, label: c.title })), [collections]);

  const items = useMemo(() => [
    { ...navItems[0], label: t("menu.managePublications") },
    { ...navItems[1], label: t("menu.manageCompany") },
    { ...navItems[2], label: t("menu.manageApps") },
    { ...navItems[3], label: t("menu.manageReader") },
    { ...navItems[4], label: t("menu.pushNotifications") },
  ], [t]);

  return (
    <div className={cn("flex w-[260px] h-screen flex-col items-center bg-promag-primary px-[10px]", className)}>
      {/* Logo */}
      <div className="flex w-full h-[69px] py-5 justify-center items-center">
        <div className="scale-75 sm:scale-100">
          <PromagLogo />
        </div>
      </div>

      {/* Navigation Items */}
      <div className="flex flex-col w-full gap-0">
        {items.map((item, index) => (
          <button
            key={index}
            onClick={() => {
              if (index === 0) {
                onManagePublicationsClick?.();
              }
            }}
            className={cn(
              "flex w-full px-3 sm:px-[26px] py-3 sm:py-4 items-center gap-2 sm:gap-[10px] rounded text-white transition-colors text-left",
              "font-inter text-xs sm:text-sm font-medium",
              item.active ? "bg-promag-secondary" : "hover:bg-promag-secondary/50"
            )}
          >
            <div className="w-3 h-3 sm:w-4 sm:h-4 text-white flex-shrink-0">
              {item.icon}
            </div>
            <span className="hidden sm:block">{item.label}</span>
          </button>
        ))}
      </div>

    </div>
  );
}
